# SkNeuro Detector

Проект представляет собой прототип нейросетевого детектора транспорта.
Он подсчитывает автомобили на видеопотоке и периодически отправляет
результаты на удалённый сервер. Для детекции используется модель YOLOv8
в формате ONNX. Пакет FastAPI обрабатывает входящие команды, пока
асинхронный цикл детекции работает в фоне.

## Требования

- Python 3.10+
- Пакеты из `requirements.txt`

Установка зависимостей:

```bash
pip install -r requirements.txt
```

## Конфигурация

Настройки хранятся в `configs/skneyro_config.yaml`. При первом запуске
файл будет создан автоматически. Основные параметры:

- `DETECTOR.model_path` – путь к ONNX-модели
- `DETECTOR.video_source` – путь к видеофайлу или индекс камеры
- `DETECTOR.vehicle_class_id` – идентификатор класса автомобилей
- `PTI.interval` – интервал между отправкой результатов (секунды)
- `NDC.adr_1` – URL сервера для приёма данных

Отредактируйте конфигурацию под свои условия.

## Запуск

```bash
python src/main.py
```

По умолчанию FastAPI сервер слушает порт `8000` (см. `communicator.py`).
Данные детекции отправляются по адресу, указанному в `NDC.adr_1`.

## Тестирование системы

1. Подготовьте тестовое видео и укажите путь в `DETECTOR.video_source`.
2. Убедитесь, что сервер в `NDC.adr_1` доступен (можно использовать
   `httpbin.org/post` для проверки).
3. Запустите приложение и наблюдайте за логами FPS и статусом POST-запросов.
4. Для отправки команды выполните POST-запрос на
   `http://localhost:8000/command` с полем `message`, содержащим
   строку протокола. Полученное сообщение будет разобрано и залогировано.

Такую конфигурацию можно использовать как на обычном ПК, так и на
микрокомпьютерах, например Jetson Nano (при наличии провайдера TensorRT).
